<% connected = instagram_connected?(chatbot) %>
<% instagram_auth_url = "#{Rails.application.credentials.dig(:instagram, :auth_url)}&state=#{chatbot.id}" %>

<div id="instagram-card" class="<%= connected ? instagram_card_styles : '' %>">
  <% if connected %>
    <div class="<%= instagram_card_gradient_styles %>"></div>
  <% end %>
  <div class="relative">
    <% if connected %>
      <div class="<%= instagram_background_styles %>"></div>
    <% end %>
    <div class="card bg-base-100/70 backdrop-blur-sm shadow-md relative border border-gray-200">
      <div class="card-body relative z-10">
        <div class="flex items-center mb-4">
          <div class="w-12 h-12 rounded-lg">
            <%= image_tag "https://conversalo.nyc3.cdn.digitaloceanspaces.com/ig.svg", class: "w-full h-full object-cover" %>
          </div>
          <h2 class="card-title text-stone-600 ml-4">Instagram</h2>
        </div>
        <p class="text-stone-600">Connect your chatbot to an Instagram account and let it respond to messages from your customers.</p>
        <div class="card-actions w-full mt-2">
          <div class="flex w-full">
            <%= link_to instagram_auth_url, class: "btn btn-success flex-1", target: "_blank" do %>
              <%= connected ? "Reconnect" : "Connect" %>
            <% end %>
            <% if connected %>
              <%= link_to chatbot_integrations_instagram_path(chatbot), class: "btn btn-soft ml-1", aria: { label: "Instagram settings" } do %>
                <%= icon "wrench", variant: "mini" %>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
