<div class="w-96 shrink-0">
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <%= form_with(model: @chatbot, url: chatbots_playground_path, method: :patch, class: "space-y-6", data: { turbo: true }) do |f| %>
      <!-- Model selection -->
      <div>
        <label for="model_id" class="block text-sm font-medium text-gray-900 mb-2">Model</label>
        <div class="relative">
          <%= f.collection_select :model_id, 
              Model.all, 
              :id, 
              :name, 
              {}, 
              class: "appearance-none w-full rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 shadow-xs hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-black cursor-pointer",
              disabled: @chatbot.assistant_id.blank? %>
          <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2">
            <svg class="size-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
              <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
            </svg>
          </div>
        </div>
      </div>

      <!-- Temperature slider -->
      <div>
        <label for="temperature" class="block text-sm font-medium text-gray-900 mb-2">Temperature</label>
        <div class="flex items-center gap-4">
          <%= f.range_field :temperature, 
              min: 0, 
              max: 1, 
              step: 0.1, 
              class: "w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2",
              disabled: @chatbot.assistant_id.blank? %>
          <span class="text-sm font-semibold text-gray-900 w-12 text-right tabular-nums" id="temperature-value">
            <%= @chatbot.temperature %>
          </span>
        </div>
      </div>

      <!-- System instructions -->
      <div>
        <label for="system_instructions" class="block text-sm font-medium text-gray-900 mb-2">System Instructions</label>
        <%= f.text_area :system_instructions, 
            rows: 10,
            class: "w-full rounded-md bg-white px-3 py-2 text-sm text-gray-900 ring-1 ring-inset ring-gray-300 shadow-xs placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-black",
            disabled: @chatbot.assistant_id.blank? %>
      </div>

      <!-- Submit button -->
      <div>
        <%= f.submit "Save Changes", 
            class: "cursor-pointer w-full flex justify-center rounded-md bg-black px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-stone-900 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2",
            disabled: @chatbot.assistant_id.blank? %>
      </div>
    <% end %>
  </div>
</div>

<%# JavaScript to update temperature value display %>
<%# TODO: Move to a stimulus controller %>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const temperatureInput = document.querySelector('input[type="range"]');
  const temperatureValue = document.getElementById('temperature-value');
  
  temperatureInput.addEventListener('input', function() {
    temperatureValue.textContent = Number(this.value).toFixed(1);
  });
});
</script>
