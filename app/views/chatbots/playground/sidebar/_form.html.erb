<%= turbo_frame_tag "playground_sidebar" do %>
  <%= form_with(model: chatbot, url: chatbots_playground_path(chatbot), method: :patch, class: "space-y-6", id: "sidebar_form") do |f| %>
    <!-- Model selection -->
    <div class="form-control">
      <label class="label">
        <span class="label-text">Model</span>
      </label>
      <div class="relative">
        <%= f.collection_select :model_id, 
            Model.all, 
            :id, 
            :name, 
            { selected: chatbot.model_id },
            class: "select select-bordered w-full focus-visible:outline-none focus-visible:ring focus-visible:ring-primary/20",
            disabled: chatbot.assistant_id.blank? %>
      </div>
    </div>

    <!-- Temperature slider -->
    <div data-controller="range-slider" class="form-control">
      <label class="label">
        <span class="label-text">Temperature</span>
        <span class="label-text-alt tabular-nums" data-range-slider-target="display">
          <%= chatbot.temperature %>
        </span>
      </label>
      <%= f.range_field :temperature, 
          min: 0, 
          max: 2, 
          step: 0.1, 
          class: "w-full range range-xs range-primary focus-visible:outline-none focus-visible:ring focus-visible:ring-primary/20",
          data: { 
            "range-slider-target": "input",
            action: "input->range-slider#updateDisplay"
          },
          value: chatbot.temperature,
          disabled: chatbot.assistant_id.blank? %>
    </div>

    <!-- System instructions -->
    <div class="form-control">
      <label class="label">
        <span class="label-text">System Instructions</span>
      </label>
      <%= f.text_area :system_instructions,
          value: chatbot.system_instructions,
          rows: 10,
          class: "w-full textarea textarea-bordered focus-visible:outline-none focus-visible:ring focus-visible:ring-primary/20",
          disabled: chatbot.assistant_id.blank? %>
    </div>

    <%= f.hidden_field :name, value: chatbot.name %>

    <!-- Submit button -->
    <div>
      <%= f.button type: "submit",
          id: "button_loader",
          class: "btn btn-primary w-full focus-visible:outline-none focus-visible:ring focus-visible:ring-primary/20",
          disabled: chatbot.assistant_id.blank? do %>
          <span id="sidebar_submit_button_text">
            Save Changes
          </span>
      <% end %>
    </div>
  <% end %>
<% end %>